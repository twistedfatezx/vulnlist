{
  "ID": "oval:cn.openanolis:def:20240951",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0951: security update php (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 23"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0951",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0951",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 23 that fix the following vulnerabilities:\n\nCVE-2024-2756:\nDue to an incomplete fix to  CVE-2022-31629 https://github.com/advisories/GHSA-c43m-486j-j32p , network and same-site attackers can set a standard insecure cookie in the victim's browser which is treated as a __Host- or __Secure- cookie by PHP applications. \n\nCVE-2024-3096:\nIn PHP  version 8.1.* before 8.1.28, 8.2.* before 8.2.18, 8.3.* before 8.3.5, if a password stored with password_hash() starts with a null byte (\\x00), testing a blank string as the password via password_verify() will incorrectly return true.\n\nCVE-2024-5585:\nIn PHP versions 8.1.* before 8.1.29, 8.2.* before 8.2.20, 8.3.* before 8.3.8, the fix for CVE-2024-1874 does not work if the command name includes trailing spaces. Original issue: when using proc_open() command with array syntax, due to insufficient escaping, if the arguments of the executed command are controlled by a malicious user, the user can supply arguments that would execute arbitrary commands in Windows shell.\n\nCVE-2024-1874:\nIn PHP versions 8.1.* before 8.1.28, 8.2.* before 8.2.18, 8.3.* before 8.3.5, when using proc_open() command with array syntax, due to insufficient escaping, if the arguments of the executed command are controlled by a malicious user, the user can supply arguments that would execute arbitrary commands in Windows shell.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2024-10-09"
      },
      "Updated": {
        "Date": "2024-10-09"
      },
      "Cves": [
        {
          "ID": "CVE-2024-2756",
          "CVSS3": "6.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-2756",
          "CWE": "CWE-20",
          "Public": "20241009"
        },
        {
          "ID": "CVE-2024-3096",
          "CVSS3": "4.8/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-3096",
          "CWE": "CWE-626",
          "Public": "20241009"
        },
        {
          "ID": "CVE-2024-5585",
          "CVSS3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-5585",
          "CWE": "CWE-78",
          "Public": "20241009"
        },
        {
          "ID": "CVE-2024-1874",
          "CVSS3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-1874",
          "CWE": "CWE-78",
          "Public": "20241009"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:23:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "php is earlier than 0:8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951001"
          },
          {
            "Comment": "php-bcmath is earlier than 0:bcmath-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951002"
          },
          {
            "Comment": "php-cli is earlier than 0:cli-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951003"
          },
          {
            "Comment": "php-common is earlier than 0:common-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951004"
          },
          {
            "Comment": "php-dba is earlier than 0:dba-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951005"
          },
          {
            "Comment": "php-dbg is earlier than 0:dbg-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951006"
          },
          {
            "Comment": "php-devel is earlier than 0:devel-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951007"
          },
          {
            "Comment": "php-embedded is earlier than 0:embedded-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951008"
          },
          {
            "Comment": "php-enchant is earlier than 0:enchant-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951009"
          },
          {
            "Comment": "php-ffi is earlier than 0:ffi-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951010"
          },
          {
            "Comment": "php-fpm is earlier than 0:fpm-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951011"
          },
          {
            "Comment": "php-gd is earlier than 0:gd-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951012"
          },
          {
            "Comment": "php-gmp is earlier than 0:gmp-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951013"
          },
          {
            "Comment": "php-intl is earlier than 0:intl-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951014"
          },
          {
            "Comment": "php-ldap is earlier than 0:ldap-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951015"
          },
          {
            "Comment": "php-mbstring is earlier than 0:mbstring-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951016"
          },
          {
            "Comment": "php-mysqlnd is earlier than 0:mysqlnd-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951017"
          },
          {
            "Comment": "php-odbc is earlier than 0:odbc-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951018"
          },
          {
            "Comment": "php-opcache is earlier than 0:opcache-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951019"
          },
          {
            "Comment": "php-pdo is earlier than 0:pdo-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951020"
          },
          {
            "Comment": "php-pgsql is earlier than 0:pgsql-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951021"
          },
          {
            "Comment": "php-process is earlier than 0:process-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951022"
          },
          {
            "Comment": "php-snmp is earlier than 0:snmp-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951023"
          },
          {
            "Comment": "php-soap is earlier than 0:soap-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951024"
          },
          {
            "Comment": "php-sodium is earlier than 0:sodium-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951025"
          },
          {
            "Comment": "php-xml is earlier than 0:xml-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951026"
          },
          {
            "Comment": "php-zip is earlier than 0:zip-8.2.20-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20240951027"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 23 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}