{
  "ID": "oval:cn.openanolis:def:20230733",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2023:0733: postgresql security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 23"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2023:0733",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2023:0733",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 23 that fix the following vulnerabilities:\n\nCVE-2023-39417:\nIN THE EXTENSION SCRIPT, a SQL Injection vulnerability was found in PostgreSQL if it uses @extowner@, @extschema@, or @extschema:...@ inside a quoting construct (dollar quoting, '', or \"\"). If an administrator has installed files of a vulnerable, trusted, non-bundled extension, an attacker with database-level CREATE privilege can execute arbitrary code as the bootstrap superuser.\n\nCVE-2023-39418:\nA vulnerability was found in PostgreSQL with the use of the MERGE command, which fails to test new rows against row security policies defined for UPDATE and SELECT. If UPDATE and SELECT policies forbid some rows that INSERT policies do not forbid, a user could store such rows.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2023-12-01"
      },
      "Updated": {
        "Date": "2023-12-01"
      },
      "Cves": [
        {
          "ID": "CVE-2023-39417",
          "CVSS3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-39417",
          "CWE": "CWE-89",
          "Public": "20230811"
        },
        {
          "ID": "CVE-2023-39418",
          "CVSS3": "4.3/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-39418",
          "CWE": "",
          "Public": "20230811"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:23:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "postgresql is earlier than 0:15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733001"
          },
          {
            "Comment": "postgresql-contrib is earlier than 0:contrib-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733002"
          },
          {
            "Comment": "postgresql-docs is earlier than 0:docs-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733003"
          },
          {
            "Comment": "postgresql-plperl is earlier than 0:plperl-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733004"
          },
          {
            "Comment": "postgresql-plpython3 is earlier than 0:plpython3-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733005"
          },
          {
            "Comment": "postgresql-pltcl is earlier than 0:pltcl-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733006"
          },
          {
            "Comment": "postgresql-private-devel is earlier than 0:private-devel-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733007"
          },
          {
            "Comment": "postgresql-private-libs is earlier than 0:private-libs-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733008"
          },
          {
            "Comment": "postgresql-server is earlier than 0:server-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733009"
          },
          {
            "Comment": "postgresql-server-devel is earlier than 0:server-devel-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733010"
          },
          {
            "Comment": "postgresql-static is earlier than 0:static-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733011"
          },
          {
            "Comment": "postgresql-test is earlier than 0:test-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733012"
          },
          {
            "Comment": "postgresql-upgrade is earlier than 0:upgrade-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733013"
          },
          {
            "Comment": "postgresql-upgrade-devel is earlier than 0:upgrade-devel-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733014"
          },
          {
            "Comment": "postgresql-test-rpm-macros is earlier than 0:test-rpm-macros-15.4-1.an23",
            "TestRef": "oval:cn.openanolis:tst:20230733015"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 23 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}