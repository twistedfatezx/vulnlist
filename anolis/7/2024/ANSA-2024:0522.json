{
  "ID": "oval:cn.openanolis:def:20240522",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0522: ipa security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 7"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0522",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0522",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 7 that fix the following vulnerabilities:\n\nCVE-2024-3183:\nA vulnerability was found in FreeIPA in a way when a Kerberos TGS-REQ is encrypted using the client’s session key. This key is different for each new session, which protects it from brute force attacks. However, the ticket it contains is encrypted using the target principal key directly. For user principals, this key is a hash of a public per-principal randomly-generated salt and the user’s password.\nIf a principal is compromised it means the attacker would be able to retrieve tickets encrypted to any principal, all of them being encrypted by their own key directly. By taking these tickets and salts offline, the attacker could run brute force attacks to find character strings able to decrypt tickets when combined to a principal salt (i.e. find the principal’s password).",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2024-06-27"
      },
      "Updated": {
        "Date": "2024-06-28"
      },
      "Cves": [
        {
          "ID": "CVE-2024-3183",
          "CVSS3": "8.1/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-3183",
          "CWE": "CWE-916",
          "Public": "20240627"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:7:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "ipa-client is earlier than 0:client-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522001"
          },
          {
            "Comment": "ipa-server is earlier than 0:server-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522002"
          },
          {
            "Comment": "ipa-server-trust-ad is earlier than 0:server-trust-ad-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522003"
          },
          {
            "Comment": "ipa is earlier than 0:4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522004"
          },
          {
            "Comment": "ipa-client-common is earlier than 0:client-common-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522005"
          },
          {
            "Comment": "ipa-common is earlier than 0:common-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522006"
          },
          {
            "Comment": "ipa-python-compat is earlier than 0:python-compat-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522007"
          },
          {
            "Comment": "ipa-server-common is earlier than 0:server-common-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522008"
          },
          {
            "Comment": "ipa-server-dns is earlier than 0:server-dns-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522009"
          },
          {
            "Comment": "python2-ipaclient is earlier than 0:ipaclient-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522010"
          },
          {
            "Comment": "python2-ipalib is earlier than 0:ipalib-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522011"
          },
          {
            "Comment": "python2-ipaserver is earlier than 0:ipaserver-4.6.8-5.0.1.an7.17",
            "TestRef": "oval:cn.openanolis:tst:20240522012"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 7 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}