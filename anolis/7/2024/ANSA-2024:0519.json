{
  "ID": "oval:cn.openanolis:def:20240519",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0519: kernel security and bug fix update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 7"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0519",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0519",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 7 that fix the following vulnerabilities:\n\nCVE-2020-36558:\nA race condition in the Linux kernel before 5.5.7 involving VT_RESIZEX could lead to a NULL pointer dereference and general protection fault.\n\nCVE-2023-2002:\nA vulnerability was found in the HCI sockets implementation due to a missing capability check in net/bluetooth/hci_sock.c in the Linux Kernel. This flaw allows an attacker to unauthorized execution of management commands, compromising the confidentiality, integrity, and availability of Bluetooth communication.\n\nCVE-2023-25775:\nImproper access control in the Intel(R) Ethernet Controller RDMA driver for linux before version 1.9.30 may allow an unauthenticated user to potentially enable escalation of privilege via network access.\n\nCVE-2023-4622:\nA use-after-free vulnerability in the Linux kernel's af_unix component can be exploited to achieve local privilege escalation.\nThe unix_stream_sendpage() function tries to add data to the last skb in the peer's recv queue without locking the queue. Thus there is a race where unix_stream_sendpage() could access an skb locklessly that is being released by garbage collection, resulting in use-after-free.\nWe recommend upgrading past commit 790c2f9d15b594350ae9bca7b236f2b1859de02c.\n\nCVE-2023-4623:\nA use-after-free vulnerability in the Linux kernel's net/sched: sch_hfsc (HFSC qdisc traffic control) component can be exploited to achieve local privilege escalation.\nIf a class with a link-sharing curve (i.e. with the HFSC_FSC flag set) has a parent without a link-sharing curve, then init_vf() will call vttree_insert() on the parent, but vttree_remove() will be skipped in update_vf(). This leaves a dangling pointer that can cause a use-after-free.\nWe recommend upgrading past commit b3d26c5702c7d6c45456326e56d2ccf3f103e60f.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2024-06-27"
      },
      "Updated": {
        "Date": "2024-06-28"
      },
      "Cves": [
        {
          "ID": "CVE-2020-36558",
          "CVSS3": "5.1/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-36558",
          "CWE": "CWE-476",
          "Public": "20220720"
        },
        {
          "ID": "CVE-2023-2002",
          "CVSS3": "6.8/CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-2002",
          "CWE": "CWE-250",
          "Public": "20230526"
        },
        {
          "ID": "CVE-2023-25775",
          "CVSS3": "5.6/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-25775",
          "CWE": "CWE-284",
          "Public": "20230820"
        },
        {
          "ID": "CVE-2023-4622",
          "CVSS3": "6.6/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-4622",
          "CWE": "CWE-416",
          "Public": "20230906"
        },
        {
          "ID": "CVE-2023-4623",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-4623",
          "CWE": "CWE-416",
          "Public": "20230906"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:7:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "bpftool is earlier than 0:3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519001"
          },
          {
            "Comment": "kernel is earlier than 0:3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519002"
          },
          {
            "Comment": "kernel-debug is earlier than 0:debug-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519003"
          },
          {
            "Comment": "kernel-debug-devel is earlier than 0:debug-devel-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519004"
          },
          {
            "Comment": "kernel-devel is earlier than 0:devel-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519005"
          },
          {
            "Comment": "kernel-headers is earlier than 0:headers-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519006"
          },
          {
            "Comment": "kernel-tools is earlier than 0:tools-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519007"
          },
          {
            "Comment": "kernel-tools-libs is earlier than 0:tools-libs-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519008"
          },
          {
            "Comment": "kernel-tools-libs-devel is earlier than 0:tools-libs-devel-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519009"
          },
          {
            "Comment": "perf is earlier than 0:3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519010"
          },
          {
            "Comment": "python-perf is earlier than 0:perf-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519011"
          },
          {
            "Comment": "kernel-abi-whitelists is earlier than 0:abi-whitelists-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519012"
          },
          {
            "Comment": "kernel-doc is earlier than 0:doc-3.10.0-1160.118.1.0.1.an7",
            "TestRef": "oval:cn.openanolis:tst:20240519013"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 7 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}