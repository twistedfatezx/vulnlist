{
  "ID": "oval:cn.openanolis:def:20220777",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2022:0777: ANSA: kernel security and bug fix update: kernel-4.19.91-26.6 (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 7"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2022:0777",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2022:0777",
        "Source": "ANSA"
      }
    ],
    "Description": "The Linux kernel, based on version 4.19.91, heavily modified with backports.\n\nCVE-2021-33656:\nWhen setting font with malicous data by ioctl cmd PIO_FONT,kernel will write memory out of bounds.\n\nCVE-2021-4037:\nA vulnerability was found in the fs/inode.c:inode_init_owner() function logic of the LInux kernel that allows local users to create files for the XFS file-system with an unintended group ownership and with group execution and SGID permission bits set, in a scenario where a directory is SGID and belongs to a certain group and is writable by a user who is not a member of this group. This can lead to excessive permissions granted in case when they should not. This vulnerability is similar to the previous CVE-2018-13405 and adds the missed fix for the XFS.\n\nCVE-2021-4159:\nA vulnerability was found in the Linux kernel's EBPF verifier when handling internal data structures. Internal memory locations could be returned to userspace. A local attacker with the permissions to insert eBPF code to the kernel can use this to leak internal kernel memory details defeating some of the exploit mitigations in place for the kernel.\n\nCVE-2022-1048:\nA use-after-free flaw was found in the Linux kernel?s sound subsystem in the way a user triggers concurrent calls of PCM hw_params. The hw_free ioctls or similar race condition happens inside ALSA PCM for other ioctls. This flaw allows a local user to crash or potentially escalate their privileges on the system.\n\nCVE-2022-1184:\nA use-after-free flaw was found in fs/ext4/namei.c:dx_insert_block() in the Linux kernel?s filesystem sub-component. This flaw allows a local attacker with a user privilege to cause a denial of service.\n\nCVE-2022-1198:\nA use-after-free vulnerabilitity was discovered in drivers/net/hamradio/6pack.c of linux that allows an attacker to crash linux kernel by simulating ax25 device using 6pack driver from user space.\n\nCVE-2022-1462:\nAn out-of-bounds read flaw was found in the Linux kernel?s TeleTYpe subsystem. The issue occurs in how a user triggers a race condition using ioctls TIOCSPTLCK and TIOCGPTPEER and TIOCSTI and TCXONC with leakage of memory in the flush_to_ldisc function. This flaw allows a local user to crash the system or read unauthorized random data from memory.\n\nCVE-2022-1679:\nA use-after-free flaw was found in the Linux kernel?s Atheros wireless adapter driver in the way a user forces the ath9k_htc_wait_for_target function to fail with some input messages. This flaw allows a local user to crash or potentially escalate their privileges on the system.\n\nCVE-2022-1734:\nA flaw in Linux Kernel found in nfcmrvl_nci_unregister_dev() in drivers/nfc/nfcmrvl/main.c can lead to use after free both read or write when non synchronized between cleanup routine and firmware download routine.\n\nCVE-2022-2153:\nA flaw was found in the Linux kernel?s KVM when attempting to set a SynIC IRQ. This issue makes it possible for a misbehaving VMM to write to SYNIC/STIMER MSRs, causing a NULL pointer dereference. This flaw allows an unprivileged local attacker on the host to issue specific ioctl calls, causing a kernel oops condition that results in a denial of service.\n\nCVE-2022-2318:\nThere are use-after-free vulnerabilities caused by timer handler in net/rose/rose_timer.c of linux that allow attackers to crash linux kernel without any privileges.\n\nCVE-2022-24958:\ndrivers/usb/gadget/legacy/inode.c in the Linux kernel through 5.16.8 mishandles dev-\u003ebuf release.\n\nCVE-2022-25258:\nAn issue was discovered in drivers/usb/gadget/composite.c in the Linux kernel before 5.16.10. The USB Gadget subsystem lacks certain validation of interface OS descriptor requests (ones with a large array index and ones associated with NULL function pointer retrieval). Memory corruption might occur.\n\nCVE-2022-2588:\nA use-after-free flaw was found in route4_change in the net/sched/cls_route.c filter implementation in the Linux kernel. This flaw allows a local user to crash the system and possibly lead to a local privilege escalation problem.\n\nCVE-2022-2602:\nA race issue between handling an io_uring request and the Unix socket garbage collector was found in the Linux kernel. This flaw allows an attacker to have local privilege escalation.\n\nCVE-2022-26490:\nst21nfca_connectivity_event_received in drivers/nfc/st21nfca/se.c in the Linux kernel through 5.16.12 has EVT_TRANSACTION buffer overflows because of untrusted length parameters.\n\nCVE-2022-27223:\nIn drivers/usb/gadget/udc/udc-xilinx.c in the Linux kernel before 5.16.12, the endpoint index is not validated and might be manipulated by the host for out-of-array access.\n\nCVE-2022-28388:\nusb_8dev_start_xmit in drivers/net/can/usb/usb_8dev.c in the Linux kernel through 5.17.1 has a double free.\n\nCVE-2022-28389:\nmcba_usb_start_xmit in drivers/net/can/usb/mcba_usb.c in the Linux kernel through 5.17.1 has a double free.\n\nCVE-2022-28390:\nems_usb_start_xmit in drivers/net/can/usb/ems_usb.c in the Linux kernel through 5.17.1 has a double free.\n\nCVE-2022-30594:\nThe Linux kernel before 5.17.2 mishandles seccomp permissions. The PTRACE_SEIZE code path allows attackers to bypass intended restrictions on setting the PT_SUSPEND_SECCOMP flag.\n\nCVE-2022-3202:\nA NULL pointer dereference flaw in diFree in fs/jfs/inode.c in Journaled File System (JFS)in the Linux kernel. This could allow a local attacker to crash the system or leak kernel internal information.\n\nCVE-2022-36946:\nnfqnl_mangle in net/netfilter/nfnetlink_queue.c in the Linux kernel through 5.18.14 allows remote attackers to cause a denial of service (panic) because, in the case of an nf_queue verdict with a one-byte nfta_payload attribute, an skb_pull can encounter a negative skb-\u003elen.\n\nCVE-2022-39188:\nAn issue was discovered in include/asm-generic/tlb.h in the Linux kernel before 5.19. Because of a race condition (unmap_mapping_range versus munmap), a device driver can free a page while it still has stale TLB entries. This only occurs in situations with VM_PFNMAP VMAs.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2022-11-03"
      },
      "Updated": {
        "Date": "2022-11-04"
      },
      "Cves": [
        {
          "ID": "CVE-2022-28388",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-28388",
          "CWE": "CWE-415",
          "Public": "20220404"
        },
        {
          "ID": "CVE-2022-28389",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-28389",
          "CWE": "CWE-415",
          "Public": "20220404"
        },
        {
          "ID": "CVE-2022-28390",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-28390",
          "CWE": "CWE-415",
          "Public": "20220404"
        },
        {
          "ID": "CVE-2022-30594",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-30594",
          "CWE": "CWE-276",
          "Public": "20220511"
        },
        {
          "ID": "CVE-2021-4159",
          "CVSS3": "4.4/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-4159",
          "CWE": "CWE-202-\u003eCWE-1230",
          "Public": "20220825"
        },
        {
          "ID": "CVE-2022-2602",
          "CVSS3": "7.3/CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-2602",
          "CWE": "CWE-416",
          "Public": "20230110"
        },
        {
          "ID": "CVE-2022-3202",
          "CVSS3": "7.1/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-3202",
          "CWE": "CWE-476",
          "Public": "20221103"
        },
        {
          "ID": "CVE-2021-33656",
          "CVSS3": "6.8/CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-33656",
          "CWE": "CWE-787",
          "Public": "20220718"
        },
        {
          "ID": "CVE-2022-1462",
          "CVSS3": "6.3/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1462",
          "CWE": "CWE-362-\u003eCWE-366",
          "Public": "20220601"
        },
        {
          "ID": "CVE-2022-2318",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-2318",
          "CWE": "CWE-416",
          "Public": "20220707"
        },
        {
          "ID": "CVE-2022-1048",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1048",
          "CWE": "CWE-416",
          "Public": "20220323"
        },
        {
          "ID": "CVE-2022-1184",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1184",
          "CWE": "CWE-416",
          "Public": "20220418"
        },
        {
          "ID": "CVE-2022-1198",
          "CVSS3": "5.1/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1198",
          "CWE": "CWE-416",
          "Public": "20220328"
        },
        {
          "ID": "CVE-2022-2588",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-2588",
          "CWE": "CWE-416",
          "Public": "20230110"
        },
        {
          "ID": "CVE-2022-39188",
          "CVSS3": "4.7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-39188",
          "CWE": "CWE-416",
          "Public": "20220901"
        },
        {
          "ID": "CVE-2022-1679",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1679",
          "CWE": "CWE-416",
          "Public": "20220516"
        },
        {
          "ID": "CVE-2022-1734",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-1734",
          "CWE": "CWE-416",
          "Public": "20220510"
        },
        {
          "ID": "CVE-2022-2153",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-2153",
          "CWE": "CWE-476",
          "Public": "20220324"
        },
        {
          "ID": "CVE-2022-36946",
          "CVSS3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-36946",
          "CWE": "",
          "Public": "20220727"
        },
        {
          "ID": "CVE-2022-24958",
          "CVSS3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-24958",
          "CWE": "CWE-416",
          "Public": "20220103"
        },
        {
          "ID": "CVE-2022-25258",
          "CVSS3": "4.6/CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-25258",
          "CWE": "CWE-476",
          "Public": "20220216"
        },
        {
          "ID": "CVE-2021-4037",
          "CVSS3": "4.4/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-4037",
          "CWE": "CWE-284",
          "Public": "20230110"
        },
        {
          "ID": "CVE-2022-26490",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-26490",
          "CWE": "CWE-120",
          "Public": "20220307"
        },
        {
          "ID": "CVE-2022-27223",
          "CVSS3": "5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-27223",
          "CWE": "CWE-120",
          "Public": "20220316"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:7:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "bpftool is earlier than 0:4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777001"
          },
          {
            "Comment": "kernel is earlier than 0:4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777002"
          },
          {
            "Comment": "kernel-debug is earlier than 0:debug-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777003"
          },
          {
            "Comment": "kernel-debug-devel is earlier than 0:debug-devel-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777004"
          },
          {
            "Comment": "kernel-devel is earlier than 0:devel-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777005"
          },
          {
            "Comment": "kernel-headers is earlier than 0:headers-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777006"
          },
          {
            "Comment": "kernel-tools is earlier than 0:tools-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777007"
          },
          {
            "Comment": "kernel-tools-libs is earlier than 0:tools-libs-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777008"
          },
          {
            "Comment": "kernel-tools-libs-devel is earlier than 0:tools-libs-devel-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777009"
          },
          {
            "Comment": "perf is earlier than 0:4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777010"
          },
          {
            "Comment": "python-perf is earlier than 0:perf-4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777011"
          },
          {
            "Comment": "kernel(ANCK)4.19 is earlier than 0:4.19.91-26.6.an7",
            "TestRef": "oval:cn.openanolis:tst:20220777012"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 7 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}