{
  "ID": "oval:cn.openanolis:def:20230236",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2023:0236: git security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 7"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2023:0236",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2023:0236",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 7 that fix the following vulnerabilities:\n\nCVE-2023-25652:\nGit is a revision control system. Prior to versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1, by feeding specially crafted input to `git apply --reject`, a path outside the working tree can be overwritten with partially controlled contents (corresponding to the rejected hunk(s) from the given patch). A fix is available in versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1. As a workaround, avoid using `git apply` with `--reject` when applying patches from an untrusted source. Use `git apply --stat` to inspect a patch before applying; avoid applying one that create a conflict where a link corresponding to the `*.rej` file exists.\n\nCVE-2023-29007:\nGit is a revision control system. Prior to versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1, a specially crafted `.gitmodules` file with submodule URLs that are longer than 1024 characters can used to exploit a bug in `config.c::git_config_copy_or_rename_section_in_file()`. This bug can be used to inject arbitrary configuration into a user's `$GIT_DIR/config` when attempting to remove the configuration section associated with that submodule. When the attacker injects configuration values which specify executables to run (such as `core.pager`, `core.editor`, `core.sshCommand`, etc.) this can lead to a remote code execution. A fix A fix is available in versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1. As a workaround, avoid running `git submodule deinit` on untrusted repositories or without prior inspection of any submodule sections in `$GIT_DIR/config`.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2023-05-31"
      },
      "Updated": {
        "Date": "2023-06-01"
      },
      "Cves": [
        {
          "ID": "CVE-2023-25652",
          "CVSS3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-25652",
          "CWE": "",
          "Public": "20230426"
        },
        {
          "ID": "CVE-2023-29007",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-29007",
          "CWE": "",
          "Public": "20230524"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:7:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "git is earlier than 0:1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236001"
          },
          {
            "Comment": "git-daemon is earlier than 0:daemon-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236002"
          },
          {
            "Comment": "git-gnome-keyring is earlier than 0:gnome-keyring-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236003"
          },
          {
            "Comment": "git-svn is earlier than 0:svn-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236004"
          },
          {
            "Comment": "emacs-git is earlier than 0:git-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236005"
          },
          {
            "Comment": "emacs-git-el is earlier than 0:git-el-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236006"
          },
          {
            "Comment": "git-all is earlier than 0:all-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236007"
          },
          {
            "Comment": "git-bzr is earlier than 0:bzr-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236008"
          },
          {
            "Comment": "git-cvs is earlier than 0:cvs-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236009"
          },
          {
            "Comment": "git-email is earlier than 0:email-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236010"
          },
          {
            "Comment": "git-gui is earlier than 0:gui-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236011"
          },
          {
            "Comment": "git-hg is earlier than 0:hg-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236012"
          },
          {
            "Comment": "git-instaweb is earlier than 0:instaweb-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236013"
          },
          {
            "Comment": "git-p4 is earlier than 0:p4-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236014"
          },
          {
            "Comment": "gitk is earlier than 0:1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236015"
          },
          {
            "Comment": "gitweb is earlier than 0:1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236016"
          },
          {
            "Comment": "perl-Git is earlier than 0:Git-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236017"
          },
          {
            "Comment": "perl-Git-SVN is earlier than 0:Git-SVN-1.8.3.1-25.an7",
            "TestRef": "oval:cn.openanolis:tst:20230236018"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 7 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}