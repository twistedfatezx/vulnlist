{
  "ID": "oval:cn.openanolis:def:20230489",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2023:0489: subscription-manager security update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 7"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2023:0489",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2023:0489",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 7 that fix the following vulnerabilities:\n\nCVE-2023-3899:\nA vulnerability was found in subscription-manager that allows local privilege escalation due to inadequate authorization. The D-Bus interface com.redhat.RHSM1 exposes a significant number of methods to all users that could change the state of the registration. By using the com.redhat.RHSM1.Config.SetAll() method, a low-privileged local user could tamper with the state of the registration, by unregistering the system or by changing the current entitlements. This flaw allows an attacker to set arbitrary configuration directives for /etc/rhsm/rhsm.conf, which can be abused to cause a local privilege escalation to an unconfined root.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2023-09-01"
      },
      "Updated": {
        "Date": "2023-09-04"
      },
      "Cves": [
        {
          "ID": "CVE-2023-3899",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3899",
          "CWE": "CWE-285",
          "Public": "20230901"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:7:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "python-syspurpose is earlier than 0:syspurpose-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489001"
          },
          {
            "Comment": "rhsm-gtk is earlier than 0:gtk-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489002"
          },
          {
            "Comment": "subscription-manager is earlier than 0:manager-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489003"
          },
          {
            "Comment": "subscription-manager-gui is earlier than 0:manager-gui-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489004"
          },
          {
            "Comment": "subscription-manager-initial-setup-addon is earlier than 0:manager-initial-setup-addon-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489005"
          },
          {
            "Comment": "subscription-manager-plugin-container is earlier than 0:manager-plugin-container-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489006"
          },
          {
            "Comment": "subscription-manager-plugin-ostree is earlier than 0:manager-plugin-ostree-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489007"
          },
          {
            "Comment": "subscription-manager-rhsm is earlier than 0:manager-rhsm-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489008"
          },
          {
            "Comment": "subscription-manager-rhsm-certificates is earlier than 0:manager-rhsm-certificates-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489009"
          },
          {
            "Comment": "subscription-manager-cockpit is earlier than 0:manager-cockpit-1.24.52-2.an7",
            "TestRef": "oval:cn.openanolis:tst:20230489010"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 7 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}