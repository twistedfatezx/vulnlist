{
  "ID": "oval:cn.openanolis:def:20230525",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2023:0525: ANSA: kernel bugfix update: kernel-4.19.91-27.6 (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2023:0525",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2023:0525",
        "Source": "ANSA"
      }
    ],
    "Description": "The Linux kernel, based on version 4.19.91, heavily modified with backports\n\nCVE-2023-0459:\nCopy_from_user on 64-bit versions of the Linux kernel does not implement the __uaccess_begin_nospec allowing a user to bypass the \"access_ok\" check and pass a kernel pointer to copy_from_user(). This would allow an attacker to leak information. We recommend upgrading beyond commit 74e19ef0ff8061ef55957c3abd71614ef0f42f47\n\nCVE-2023-2124:\nAn out-of-bounds memory access flaw was found in the Linux kernel’s XFS file system in how a user restores an XFS image after failure (with a dirty log journal). This flaw allows a local user to crash or potentially escalate their privileges on the system.\n\nCVE-2023-2162:\nA use-after-free vulnerability was found in iscsi_sw_tcp_session_create in drivers/scsi/iscsi_tcp.c in SCSI sub-component in the Linux Kernel. In this flaw an attacker could leak kernel internal information.\n\nCVE-2023-30456:\nAn issue was discovered in arch/x86/kvm/vmx/nested.c in the Linux kernel before 6.2.8. nVMX on x86_64 lacks consistency checks for CR0 and CR4.\n\nCVE-2023-3090:\nA heap out-of-bounds write vulnerability in the Linux Kernel ipvlan network driver can be exploited to achieve local privilege escalation. The out-of-bounds write is caused by missing skb-\u003ecb initialization in the ipvlan network driver. The vulnerability is reachable if CONFIG_IPVLAN is enabled. We recommend upgrading past commit 90cbed5247439a966b645b34eb0a2e037836ea8e.\n\nCVE-2023-31084:\nAn issue was discovered in drivers/media/dvb-core/dvb_frontend.c in the Linux kernel 6.2. There is a blocking operation when a task is in !TASK_RUNNING. In dvb_frontend_get_event, wait_event_interruptible is called; the condition is dvb_frontend_test_event(fepriv,events). In dvb_frontend_test_event, down(\u0026fepriv-\u003esem) is called. However, wait_event_interruptible would put the process to sleep, and down(\u0026fepriv-\u003esem) may block the process.\n\nCVE-2023-3111:\nA use after free vulnerability was found in prepare_to_relocate in fs/btrfs/relocation.c in btrfs in the Linux Kernel. This possible flaw can be triggered by calling btrfs_ioctl_balance() before calling btrfs_ioctl_defrag().\n\nCVE-2023-3117:\nA use-after-free flaw was found in the Netfilter subsystem of the Linux kernel when processing named and anonymous sets in batch requests, which can lead to performing arbitrary reads and writes in kernel memory. This flaw allows a local user with CAP_NET_ADMIN capability to crash or potentially escalate their privileges on the system.\n\nCVE-2023-31436:\nqfq_change_class in net/sched/sch_qfq.c in the Linux kernel before 6.2.13 allows an out-of-bounds write because lmax can exceed QFQ_MIN_LMAX.\n\nCVE-2023-3212:\nA NULL pointer dereference issue was found in the gfs2 file system in the Linux kernel. It occurs on corrupt gfs2 file systems when the evict code tries to reference the journal descriptor structure after it has been freed and set to NULL. A privileged local user could use this flaw to cause a kernel panic.\n\nCVE-2023-34256:\n** DISPUTED ** An issue was discovered in the Linux kernel before 6.3.3. There is an out-of-bounds read in crc16 in lib/crc16.c when called from fs/ext4/super.c because ext4_group_desc_csum does not properly check an offset. NOTE: this is disputed by third parties because the kernel is not intended to defend against attackers with the stated \"When modifying the block device while it is mounted by the filesystem\" access.\n\nCVE-2023-3609:\nA use-after-free vulnerability in the Linux kernel's net/sched: cls_u32 component can be exploited to achieve local privilege escalation. If tcf_change_indev() fails, u32_set_parms() will immediately return an error after incrementing or decrementing the reference counter in tcf_bind_filter(). If an attacker can control the reference counter and set it to zero, they can cause the reference to be freed, leading to a use-after-free vulnerability. We recommend upgrading past commit 04c55383fa5689357bcdd2c8036725a55ed632bc.\n\nCVE-2023-3611:\nAn out-of-bounds write vulnerability in the Linux kernel's net/sched: sch_qfq component can be exploited to achieve local privilege escalation. The qfq_change_agg() function in net/sched/sch_qfq.c allows an out-of-bounds write because lmax is updated according to packet sizes without bounds checks. We recommend upgrading past commit 3e337087c3b5805fe0b8a46ba622a962880b5d64.\n\nCVE-2023-3776:\nA use-after-free vulnerability in the Linux kernel's net/sched: cls_fw component can be exploited to achieve local privilege escalation. If tcf_change_indev() fails, fw_set_parms() will immediately return an error after incrementing or decrementing the reference counter in tcf_bind_filter(). If an attacker can control the reference counter and set it to zero, they can cause the reference to be freed, leading to a use-after-free vulnerability. We recommend upgrading past commit 0323bce598eea038714f941ce2b22541c46d488f.\n\nCVE-2023-3812:\nAn out-of-bounds memory access flaw was found in the Linux kernel’s TUN/TAP device driver functionality in how a user generates a malicious (too big) networking packet when napi frags is enabled. This flaw allows a local user to crash or potentially escalate their privileges on the system.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2023-09-15"
      },
      "Updated": {
        "Date": "2023-09-18"
      },
      "Cves": [
        {
          "ID": "CVE-2023-0459",
          "CVSS3": "7.5/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-0459",
          "CWE": "CWE-402",
          "Public": "20230515"
        },
        {
          "ID": "CVE-2023-2124",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-2124",
          "CWE": "CWE-125",
          "Public": "20230515"
        },
        {
          "ID": "CVE-2023-2162",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-2162",
          "CWE": "CWE-416",
          "Public": "20230419"
        },
        {
          "ID": "CVE-2023-30456",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-30456",
          "CWE": "CWE-358",
          "Public": "20230410"
        },
        {
          "ID": "CVE-2023-3090",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3090",
          "CWE": "CWE-787",
          "Public": "20230628"
        },
        {
          "ID": "CVE-2023-31084",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-31084",
          "CWE": "",
          "Public": "20230423"
        },
        {
          "ID": "CVE-2023-3111",
          "CVSS3": "6.7/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3111",
          "CWE": "CWE-416",
          "Public": "20230605"
        },
        {
          "ID": "CVE-2023-3117",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3117",
          "CWE": "",
          "Public": "20230628"
        },
        {
          "ID": "CVE-2023-31436",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-31436",
          "CWE": "CWE-787",
          "Public": "20230428"
        },
        {
          "ID": "CVE-2023-3212",
          "CVSS3": "4.4/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3212",
          "CWE": "CWE-476",
          "Public": "20230623"
        },
        {
          "ID": "CVE-2023-34256",
          "CVSS3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-34256",
          "CWE": "",
          "Public": "20230531"
        },
        {
          "ID": "CVE-2023-3609",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3609",
          "CWE": "CWE-415",
          "Public": "20230724"
        },
        {
          "ID": "CVE-2023-3611",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3611",
          "CWE": "CWE-787",
          "Public": "20230724"
        },
        {
          "ID": "CVE-2023-3776",
          "CVSS3": "6.7/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3776",
          "CWE": "CWE-416",
          "Public": "20230720"
        },
        {
          "ID": "CVE-2023-3812",
          "CVSS3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3812",
          "CWE": "(CWE-416|CWE-787)",
          "Public": "20230719"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "bpftool is earlier than 0:4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525001"
          },
          {
            "Comment": "kernel is earlier than 0:4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525002"
          },
          {
            "Comment": "kernel-core is earlier than 0:core-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525003"
          },
          {
            "Comment": "kernel-debug is earlier than 0:debug-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525004"
          },
          {
            "Comment": "kernel-debug-core is earlier than 0:debug-core-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525005"
          },
          {
            "Comment": "kernel-debug-devel is earlier than 0:debug-devel-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525006"
          },
          {
            "Comment": "kernel-debug-modules is earlier than 0:debug-modules-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525007"
          },
          {
            "Comment": "kernel-debug-modules-extra is earlier than 0:debug-modules-extra-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525008"
          },
          {
            "Comment": "kernel-devel is earlier than 0:devel-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525009"
          },
          {
            "Comment": "kernel-headers is earlier than 0:headers-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525010"
          },
          {
            "Comment": "kernel-modules is earlier than 0:modules-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525011"
          },
          {
            "Comment": "kernel-modules-extra is earlier than 0:modules-extra-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525012"
          },
          {
            "Comment": "kernel-tools is earlier than 0:tools-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525013"
          },
          {
            "Comment": "kernel-tools-libs is earlier than 0:tools-libs-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525014"
          },
          {
            "Comment": "kernel-tools-libs-devel is earlier than 0:tools-libs-devel-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525015"
          },
          {
            "Comment": "perf is earlier than 0:4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525016"
          },
          {
            "Comment": "python3-perf is earlier than 0:perf-4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525017"
          },
          {
            "Comment": "kernel(ANCK)4.19 is earlier than 0:4.19.91-27.6.an8",
            "TestRef": "oval:cn.openanolis:tst:20230525018"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}