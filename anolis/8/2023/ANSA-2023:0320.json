{
  "ID": "oval:cn.openanolis:def:20230320",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2023:0320: php:7.4 security update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2023:0320",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2023:0320",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2022-31628:\nIn PHP versions before 7.4.31, 8.0.24 and 8.1.11, the phar uncompressor code would recursively uncompress \"quines\" gzip files, resulting in an infinite loop.\n\nCVE-2022-31629:\nIn PHP versions before 7.4.31, 8.0.24 and 8.1.11, the vulnerability enables network and same-site attackers to set a standard insecure cookie in the victim's browser which is treated as a `__Host-` or `__Secure-` cookie by PHP applications.\n\nCVE-2022-31630:\nIn PHP versions prior to 7.4.33, 8.0.25 and 8.2.12, when using imageloadfont() function in gd extension, it is possible to supply a specially crafted font file, such as if the loaded font is used with imagechar() function, the read outside allocated buffer will be used. This can lead to crashes or disclosure of confidential information.\n\nCVE-2022-31631:\nA flaw was found in PHP. This issue occurs due to an uncaught integer overflow in PDO::quote() of PDO_SQLite returning an improperly quoted string. With the implementation of sqlite3_snprintf(), it is possible to force the function to return a single apostrophe if the function is called on user-supplied input without any length restrictions in place.\n\nCVE-2022-37454:\nThe Keccak XKCP SHA-3 reference implementation before fdc6fef has an integer overflow and resultant buffer overflow that allows attackers to execute arbitrary code or eliminate expected cryptographic properties. This occurs in the sponge function interface.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2023-06-28"
      },
      "Updated": {
        "Date": "2023-06-29"
      },
      "Cves": [
        {
          "ID": "CVE-2022-31628",
          "CVSS3": "4.4/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-31628",
          "CWE": "CWE-674",
          "Public": "20230628"
        },
        {
          "ID": "CVE-2022-31629",
          "CVSS3": "6.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-31629",
          "CWE": "CWE-20",
          "Public": "20230628"
        },
        {
          "ID": "CVE-2022-31630",
          "CVSS3": "6.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-31630",
          "CWE": "CWE-20-\u003eCWE-125",
          "Public": "20230628"
        },
        {
          "ID": "CVE-2022-31631",
          "CVSS3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-31631",
          "CWE": "CWE-190",
          "Public": "20230105"
        },
        {
          "ID": "CVE-2022-37454",
          "CVSS3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2022-37454",
          "CWE": "CWE-680",
          "Public": "20230628"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "libzip is earlier than 0:1.6.1-1.module+an8.7.0+10886+394d5055",
            "TestRef": "oval:cn.openanolis:tst:20230320001"
          },
          {
            "Comment": "libzip-devel is earlier than 0:devel-1.6.1-1.module+an8.7.0+10886+394d5055",
            "TestRef": "oval:cn.openanolis:tst:20230320002"
          },
          {
            "Comment": "libzip-tools is earlier than 0:tools-1.6.1-1.module+an8.7.0+10886+394d5055",
            "TestRef": "oval:cn.openanolis:tst:20230320003"
          },
          {
            "Comment": "php is earlier than 0:7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320004"
          },
          {
            "Comment": "php-bcmath is earlier than 0:bcmath-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320005"
          },
          {
            "Comment": "php-cli is earlier than 0:cli-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320006"
          },
          {
            "Comment": "php-common is earlier than 0:common-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320007"
          },
          {
            "Comment": "php-dba is earlier than 0:dba-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320008"
          },
          {
            "Comment": "php-dbg is earlier than 0:dbg-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320009"
          },
          {
            "Comment": "php-devel is earlier than 0:devel-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320010"
          },
          {
            "Comment": "php-embedded is earlier than 0:embedded-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320011"
          },
          {
            "Comment": "php-enchant is earlier than 0:enchant-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320012"
          },
          {
            "Comment": "php-ffi is earlier than 0:ffi-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320013"
          },
          {
            "Comment": "php-fpm is earlier than 0:fpm-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320014"
          },
          {
            "Comment": "php-gd is earlier than 0:gd-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320015"
          },
          {
            "Comment": "php-gmp is earlier than 0:gmp-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320016"
          },
          {
            "Comment": "php-intl is earlier than 0:intl-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320017"
          },
          {
            "Comment": "php-json is earlier than 0:json-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320018"
          },
          {
            "Comment": "php-ldap is earlier than 0:ldap-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320019"
          },
          {
            "Comment": "php-mbstring is earlier than 0:mbstring-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320020"
          },
          {
            "Comment": "php-mysqlnd is earlier than 0:mysqlnd-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320021"
          },
          {
            "Comment": "php-odbc is earlier than 0:odbc-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320022"
          },
          {
            "Comment": "php-opcache is earlier than 0:opcache-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320023"
          },
          {
            "Comment": "php-pdo is earlier than 0:pdo-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320024"
          },
          {
            "Comment": "php-pecl-apcu is earlier than 0:pecl-apcu-5.1.18-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320025"
          },
          {
            "Comment": "php-pecl-apcu-devel is earlier than 0:pecl-apcu-devel-5.1.18-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320026"
          },
          {
            "Comment": "php-pecl-rrd is earlier than 0:pecl-rrd-2.0.1-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320027"
          },
          {
            "Comment": "php-pecl-xdebug is earlier than 0:pecl-xdebug-2.9.5-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320028"
          },
          {
            "Comment": "php-pecl-zip is earlier than 0:pecl-zip-1.18.2-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320029"
          },
          {
            "Comment": "php-pgsql is earlier than 0:pgsql-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320030"
          },
          {
            "Comment": "php-process is earlier than 0:process-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320031"
          },
          {
            "Comment": "php-snmp is earlier than 0:snmp-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320032"
          },
          {
            "Comment": "php-soap is earlier than 0:soap-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320033"
          },
          {
            "Comment": "php-xml is earlier than 0:xml-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320034"
          },
          {
            "Comment": "php-xmlrpc is earlier than 0:xmlrpc-7.4.33-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320035"
          },
          {
            "Comment": "php-pear is earlier than 1:pear-1.10.13-1.0.1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320036"
          },
          {
            "Comment": "apcu-panel is earlier than 0:panel-5.1.18-1.module+an8.8.0+11049+c29125d0",
            "TestRef": "oval:cn.openanolis:tst:20230320037"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}