{
  "ID": "oval:cn.openanolis:def:20210063",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2021:0063: ruby:2.7 security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2021:0063",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2021:0063",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2020-36327:\nBundler 1.16.0 through 2.2.9 and 2.2.11 through 2.2.16 sometimes chooses a dependency source based on the highest gem version number, which means that a rogue gem found at a public source may be chosen, even if the intended choice was a private gem that is a dependency of another private gem that is explicitly depended on by the application. NOTE: it is not correct to use CVE-2021-24105 for every \"Dependency Confusion\" issue in every product.\n\nCVE-2021-31799:\nIn RDoc 3.11 through 6.x before 6.3.1, as distributed with Ruby through 3.0.1, it is possible to execute arbitrary code via | and tags in a filename.\n\nCVE-2021-31810:\nAn issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through 3.0.1. A malicious FTP server can use the PASV response to trick Net::FTP into connecting back to a given IP address and port. This potentially makes curl extract information about services that are otherwise private and not disclosed (e.g., the attacker can conduct port scans and service banner extractions).\n\nCVE-2021-32066:\nAn issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through 3.0.1. Net::IMAP does not raise an exception when StartTLS fails with an an unknown response, which might allow man-in-the-middle attackers to bypass the TLS protections by leveraging a network position between the client and the registry to block the StartTLS command, aka a \"StartTLS stripping attack.\"",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2021-08-25"
      },
      "Updated": {
        "Date": "2022-10-10"
      },
      "Cves": [
        {
          "ID": "CVE-2020-36327",
          "CVSS3": "8.8/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-36327",
          "CWE": "CWE-494",
          "Public": "20210209"
        },
        {
          "ID": "CVE-2021-31799",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-31799",
          "CWE": "CWE-77",
          "Public": "20210502"
        },
        {
          "ID": "CVE-2021-31810",
          "CVSS3": "5.4/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-31810",
          "CWE": "CWE-200",
          "Public": "20210825"
        },
        {
          "ID": "CVE-2021-32066",
          "CVSS3": "7.4/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-32066",
          "CWE": "CWE-319",
          "Public": "20210825"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "ruby is earlier than 0:2.7.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063001"
          },
          {
            "Comment": "ruby-devel is earlier than 0:devel-2.7.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063002"
          },
          {
            "Comment": "ruby-libs is earlier than 0:libs-2.7.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063003"
          },
          {
            "Comment": "rubygem-bigdecimal is earlier than 0:bigdecimal-2.0.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063004"
          },
          {
            "Comment": "rubygem-bson is earlier than 0:bson-4.8.1-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063005"
          },
          {
            "Comment": "rubygem-io-console is earlier than 0:io-console-0.5.6-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063006"
          },
          {
            "Comment": "rubygem-json is earlier than 0:json-2.3.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063007"
          },
          {
            "Comment": "rubygem-mysql2 is earlier than 0:mysql2-0.5.3-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063008"
          },
          {
            "Comment": "rubygem-openssl is earlier than 0:openssl-2.1.2-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063009"
          },
          {
            "Comment": "rubygem-pg is earlier than 0:pg-1.2.3-1.0.1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063010"
          },
          {
            "Comment": "rubygem-psych is earlier than 0:psych-3.1.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063011"
          },
          {
            "Comment": "rubygem-abrt is earlier than 0:abrt-0.4.0-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063012"
          },
          {
            "Comment": "rubygem-mongo is earlier than 0:mongo-2.11.3-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063013"
          },
          {
            "Comment": "ruby-default-gems is earlier than 0:default-gems-2.7.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063014"
          },
          {
            "Comment": "ruby-doc is earlier than 0:doc-2.7.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063015"
          },
          {
            "Comment": "rubygem-abrt-doc is earlier than 0:abrt-doc-0.4.0-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063016"
          },
          {
            "Comment": "rubygem-bson-doc is earlier than 0:bson-doc-4.8.1-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063017"
          },
          {
            "Comment": "rubygem-bundler is earlier than 0:bundler-2.2.24-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063018"
          },
          {
            "Comment": "rubygem-irb is earlier than 0:irb-1.2.6-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063019"
          },
          {
            "Comment": "rubygem-minitest is earlier than 0:minitest-5.13.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063020"
          },
          {
            "Comment": "rubygem-mongo-doc is earlier than 0:mongo-doc-2.11.3-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063021"
          },
          {
            "Comment": "rubygem-mysql2-doc is earlier than 0:mysql2-doc-0.5.3-1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063022"
          },
          {
            "Comment": "rubygem-net-telnet is earlier than 0:net-telnet-0.2.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063023"
          },
          {
            "Comment": "rubygem-pg-doc is earlier than 0:pg-doc-1.2.3-1.0.1.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063024"
          },
          {
            "Comment": "rubygem-power_assert is earlier than 0:power_assert-1.1.7-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063025"
          },
          {
            "Comment": "rubygem-rake is earlier than 0:rake-13.0.1-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063026"
          },
          {
            "Comment": "rubygem-rdoc is earlier than 0:rdoc-6.2.1.1-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063027"
          },
          {
            "Comment": "rubygem-test-unit is earlier than 0:test-unit-3.3.4-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063028"
          },
          {
            "Comment": "rubygem-xmlrpc is earlier than 0:xmlrpc-0.3.0-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063029"
          },
          {
            "Comment": "rubygems is earlier than 0:3.1.6-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063030"
          },
          {
            "Comment": "rubygems-devel is earlier than 0:devel-3.1.6-137.module+an8.4.0+10363+e9c841ec",
            "TestRef": "oval:cn.openanolis:tst:20210063031"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}