{
  "ID": "oval:cn.openanolis:def:20210202",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2021:0202: grafana security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2021:0202",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2021:0202",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2021-39226:\nGrafana is an open source data visualization platform. In affected versions unauthenticated and authenticated users are able to view the snapshot with the lowest database key by accessing the literal paths: /dashboard/snapshot/:key, or /api/snapshots/:key. If the snapshot \"public_mode\" configuration setting is set to true (vs default of false), unauthenticated users are able to delete the snapshot with the lowest database key by accessing the literal path: /api/snapshots-delete/:deleteKey. Regardless of the snapshot \"public_mode\" setting, authenticated users are able to delete the snapshot with the lowest database key by accessing the literal paths: /api/snapshots/:key, or /api/snapshots-delete/:deleteKey. The combination of deletion and viewing enables a complete walk through all snapshot data while resulting in complete snapshot data loss. This issue has been resolved in versions 8.1.6 and 7.5.11. If for some reason you cannot upgrade you can use a reverse proxy or similar to block access to the literal paths: /api/snapshots/:key, /api/snapshots-delete/:deleteKey, /dashboard/snapshot/:key, and /api/snapshots/:key. They have no normal function and can be disabled without side effects.\n\nCVE-2020-11110:\nGrafana through 6.7.1 allows stored XSS due to insufficient input protection in the originalUrl field, which allows an attacker to inject JavaScript code that will be executed after clicking on Open Original Dashboard after visiting the snapshot.\n\nCVE-2020-12052:\nGrafana version \u003c 6.7.3 is vulnerable for annotation popup XSS.\n\nCVE-2020-12245:\nGrafana before 6.7.3 allows table-panel XSS via column.title or cellLinkTooltip.\n\nCVE-2020-12458:\nAn information-disclosure flaw was found in Grafana through 6.7.3. The database directory /var/lib/grafana and database file /var/lib/grafana/grafana.db are world readable. This can result in exposure of sensitive information (e.g., cleartext or encrypted datasource passwords).\n\nCVE-2020-13430:\nGrafana before 7.0.0 allows tag value XSS via the OpenTSDB datasource.\n\nCVE-2020-24303:\nGrafana before 7.1.0-beta 1 allows XSS via a query alias for the ElasticSearch datasource.\n\nCVE-2020-27846:\nA signature verification vulnerability exists in crewjam/saml. This flaw allows an attacker to bypass SAML Authentication. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2021-12-01"
      },
      "Updated": {
        "Date": "2023-02-14"
      },
      "Cves": [
        {
          "ID": "CVE-2021-39226",
          "CVSS3": "7.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-39226",
          "CWE": "CWE-639",
          "Public": "20211125"
        },
        {
          "ID": "CVE-2020-11110",
          "CVSS3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-11110",
          "CWE": "CWE-79",
          "Public": "20200727"
        },
        {
          "ID": "CVE-2020-12052",
          "CVSS3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-12052",
          "CWE": "CWE-79",
          "Public": "20200427"
        },
        {
          "ID": "CVE-2020-12245",
          "CVSS3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-12245",
          "CWE": "CWE-79",
          "Public": "20200424"
        },
        {
          "ID": "CVE-2020-12458",
          "CVSS3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-12458",
          "CWE": "CWE-732",
          "Public": "20200429"
        },
        {
          "ID": "CVE-2020-13430",
          "CVSS3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-13430",
          "CWE": "CWE-79",
          "Public": "20200524"
        },
        {
          "ID": "CVE-2020-24303",
          "CVSS3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-24303",
          "CWE": "CWE-79",
          "Public": "20201028"
        },
        {
          "ID": "CVE-2020-27846",
          "CVSS3": "9.8/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Critical",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-27846",
          "CWE": "CWE-115",
          "Public": "20201221"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "grafana is earlier than 0:7.3.6-3.0.1.an8_4",
            "TestRef": "oval:cn.openanolis:tst:20210202001"
          },
          {
            "Comment": "grafana (Anolis OS 8.4) is earlier than 0:7.3.6-3.0.1.an8_4",
            "TestRef": "oval:cn.openanolis:tst:20210202002"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}