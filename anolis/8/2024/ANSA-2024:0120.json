{
  "ID": "oval:cn.openanolis:def:20240120",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0120: grafana security and enhancement update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0120",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0120",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2023-3128:\nGrafana is validating Azure AD accounts based on the email claim. \nOn Azure AD, the profile email field is not unique and can be easily modified. \nThis leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2024-04-03"
      },
      "Updated": {
        "Date": "2024-04-03"
      },
      "Cves": [
        {
          "ID": "CVE-2023-3128",
          "CVSS3": "9.4/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
          "Impact": "Critical",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-3128",
          "CWE": "CWE-305",
          "Public": "20230622"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "grafana is earlier than 0:9.2.10-7.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20240120001"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}