{
  "ID": "oval:cn.openanolis:def:20240552",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0552: curl security and bug fix update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0552",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0552",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2023-28322:\nAn information disclosure vulnerability exists in curl \u003cv8.1.0 when doing HTTP(S) transfers, libcurl might erroneously use the read callback (`CURLOPT_READFUNCTION`) to ask for data to send, even when the `CURLOPT_POSTFIELDS` option has been set, if the same handle previously wasused to issue a `PUT` request which used that callback. This flaw may surprise the application and cause it to misbehave and either send off the wrong data or use memory after free or similar in the second transfer. The problem exists in the logic for a reused handle when it is (expected to be) changed from a PUT to a POST.\n\nCVE-2023-38546:\nThis flaw allows an attacker to insert cookies at will into a running program\nusing libcurl, if the specific series of conditions are met.\nlibcurl performs transfers. In its API, an application creates \"easy handles\"\nthat are the individual handles for single transfers.\nlibcurl provides a function call that duplicates en easy handle called\n[curl_easy_duphandle](https://curl.se/libcurl/c/curl_easy_duphandle.html).\nIf a transfer has cookies enabled when the handle is duplicated, the\ncookie-enable state is also cloned - but without cloning the actual\ncookies. If the source handle did not read any cookies from a specific file on\ndisk, the cloned version of the handle would instead store the file name as\n`none` (using the four ASCII letters, no quotes).\nSubsequent use of the cloned handle that does not explicitly set a source to\nload cookies from would then inadvertently load cookies from a file named\n`none` - if such a file exists and is readable in the current directory of the\nprogram using libcurl. And if using the correct file format of course.\n\nCVE-2023-46218:\nThis flaw allows a malicious HTTP server to set \"super cookies\" in curl that\nare then passed back to more origins than what is otherwise allowed or\npossible. This allows a site to set cookies that then would get sent to\ndifferent and unrelated sites and domains.\nIt could do this by exploiting a mixed case flaw in curl's function that\nverifies a given cookie domain against the Public Suffix List (PSL). For\nexample a cookie could be set with `domain=co.UK` when the URL used a lower\ncase hostname `curl.co.uk`, even though `co.uk` is listed as a PSL domain.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2024-06-28"
      },
      "Updated": {
        "Date": "2024-07-01"
      },
      "Cves": [
        {
          "ID": "CVE-2023-28322",
          "CVSS3": "3.7/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "Impact": "Low",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-28322",
          "CWE": "CWE-440",
          "Public": "20230526"
        },
        {
          "ID": "CVE-2023-38546",
          "CVSS3": "5.0/CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-38546",
          "CWE": "CWE-73",
          "Public": "20231012"
        },
        {
          "ID": "CVE-2023-46218",
          "CVSS3": "5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-46218",
          "CWE": "CWE-201",
          "Public": "20231214"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "curl is earlier than 0:7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552001"
          },
          {
            "Comment": "curl-minimal is earlier than 0:minimal-7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552002"
          },
          {
            "Comment": "libcurl is earlier than 0:7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552003"
          },
          {
            "Comment": "libcurl-devel is earlier than 0:devel-7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552004"
          },
          {
            "Comment": "libcurl-minimal is earlier than 0:minimal-7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552005"
          },
          {
            "Comment": "curl-doc is earlier than 0:doc-7.61.1-34.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240552006"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}