{
  "ID": "oval:cn.openanolis:def:20240838",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0838: container-tools:an8 security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0838",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0838",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2023-45290:\nWhen parsing a multipart form (either explicitly with Request.ParseMultipartForm or implicitly with Request.FormValue, Request.PostFormValue, or Request.FormFile), limits on the total size of the parsed form were not applied to the memory consumed while reading a single form line. This permits a maliciously crafted input containing very long lines to cause allocation of arbitrarily large amounts of memory, potentially leading to memory exhaustion. With fix, the ParseMultipartForm function now correctly limits the maximum size of form lines.\n\nCVE-2024-1394:\nA memory leak flaw was found in Golang in the RSA encrypting/decrypting code, which might lead to a resource exhaustion vulnerability using attacker-controlled inputs​. The memory leak happens in github.com/golang-fips/openssl/openssl/rsa.go#L113. The objects leaked are pkey​ and ctx​. That function uses named return parameters to free pkey​ and ctx​ if there is an error initializing the context or setting the different properties. All return statements related to error cases follow the \"return nil, nil, fail(...)\" pattern, meaning that pkey​ and ctx​ will be nil inside the deferred function that should free them.\n\nCVE-2024-24783:\nVerifying a certificate chain which contains a certificate with an unknown public key algorithm will cause Certificate.Verify to panic. This affects all crypto/tls clients, and servers that set Config.ClientAuth to VerifyClientCertIfGiven or RequireAndVerifyClientCert. The default behavior is for TLS servers to not verify client certificates.\n\nCVE-2024-24784:\nThe ParseAddressList function incorrectly handles comments (text within parentheses) within display names. Since this is a misalignment with conforming address parsers, it can result in different trust decisions being made by programs using different parsers.\n\nCVE-2024-24789:\nThe archive/zip package's handling of certain types of invalid zip files differs from the behavior of most zip implementations. This misalignment could be exploited to create an zip file with contents that vary depending on the implementation reading the file. The archive/zip package now rejects files containing these errors.\n\nCVE-2024-3727:\nA flaw was found in the github.com/containers/image library. This flaw allows attackers to trigger unexpected authenticated registry accesses on behalf of a victim user, causing resource exhaustion, local path traversal, and other attacks.\n\nCVE-2024-37298:\ngorilla/schema converts structs to and from form values. Prior to version 1.4.1 Running `schema.Decoder.Decode()` on a struct that has a field of type `[]struct{...}` opens it up to malicious attacks regarding memory allocations, taking advantage of the sparse slice functionality. Any use of `schema.Decoder.Decode()` on a struct with arrays of other structs could be vulnerable to this memory exhaustion vulnerability. Version 1.4.1 contains a patch for the issue.\n\nCVE-2024-6104:\ngo-retryablehttp prior to 0.7.7 did not sanitize urls when writing them to its log file. This could lead to go-retryablehttp writing sensitive HTTP basic auth credentials to its log file. This vulnerability, CVE-2024-6104, was fixed in go-retryablehttp 0.7.7.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2024-08-16"
      },
      "Updated": {
        "Date": "2024-08-22"
      },
      "Cves": [
        {
          "ID": "CVE-2023-45290",
          "CVSS3": "5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-45290",
          "CWE": "CWE-20",
          "Public": "20240603"
        },
        {
          "ID": "CVE-2024-1394",
          "CVSS3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-1394",
          "CWE": "CWE-401",
          "Public": "20240320"
        },
        {
          "ID": "CVE-2024-24783",
          "CVSS3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-24783",
          "CWE": "CWE-20-\u003eCWE-400",
          "Public": "20240603"
        },
        {
          "ID": "CVE-2024-24784",
          "CVSS3": "5.4/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-24784",
          "CWE": "CWE-115",
          "Public": "20240603"
        },
        {
          "ID": "CVE-2024-24789",
          "CVSS3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-24789",
          "CWE": "CWE-20",
          "Public": "20240716"
        },
        {
          "ID": "CVE-2024-3727",
          "CVSS3": "8.3/CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-3727",
          "CWE": "CWE-354",
          "Public": "20240514"
        },
        {
          "ID": "CVE-2024-37298",
          "CVSS3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-37298",
          "CWE": "CWE-770",
          "Public": "20240701"
        },
        {
          "ID": "CVE-2024-6104",
          "CVSS3": "6.0/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-6104",
          "CWE": "CWE-532",
          "Public": "20240624"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "aardvark-dns is earlier than 2:dns-1.10.0-2.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838001"
          },
          {
            "Comment": "buildah is earlier than 0:1.34.0-1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838002"
          },
          {
            "Comment": "buildah-tests is earlier than 0:tests-1.34.0-1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838003"
          },
          {
            "Comment": "conmon is earlier than 3:2.1.10-1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838004"
          },
          {
            "Comment": "containernetworking-plugins is earlier than 1:plugins-1.4.0-5.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838005"
          },
          {
            "Comment": "containers-common is earlier than 2:common-1-82.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838006"
          },
          {
            "Comment": "crit is earlier than 0:3.18-5.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838007"
          },
          {
            "Comment": "criu is earlier than 0:3.18-5.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838008"
          },
          {
            "Comment": "criu-devel is earlier than 0:devel-3.18-5.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838009"
          },
          {
            "Comment": "criu-libs is earlier than 0:libs-3.18-5.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838010"
          },
          {
            "Comment": "crun is earlier than 0:1.14.3-2.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838011"
          },
          {
            "Comment": "fuse-overlayfs is earlier than 0:overlayfs-1.13-1.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838012"
          },
          {
            "Comment": "libslirp is earlier than 0:4.4.0-2.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838013"
          },
          {
            "Comment": "libslirp-devel is earlier than 0:devel-4.4.0-2.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838014"
          },
          {
            "Comment": "netavark is earlier than 2:1.10.3-1.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838015"
          },
          {
            "Comment": "oci-seccomp-bpf-hook is earlier than 0:seccomp-bpf-hook-1.2.10-1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838016"
          },
          {
            "Comment": "podman is earlier than 4:4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838017"
          },
          {
            "Comment": "podman-catatonit is earlier than 4:catatonit-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838018"
          },
          {
            "Comment": "podman-gvproxy is earlier than 4:gvproxy-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838019"
          },
          {
            "Comment": "podman-plugins is earlier than 4:plugins-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838020"
          },
          {
            "Comment": "podman-remote is earlier than 4:remote-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838021"
          },
          {
            "Comment": "podman-tests is earlier than 4:tests-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838022"
          },
          {
            "Comment": "python3-criu is earlier than 0:criu-3.18-5.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838023"
          },
          {
            "Comment": "runc is earlier than 1:1.1.12-4.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838024"
          },
          {
            "Comment": "skopeo is earlier than 2:1.14.5-3.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838025"
          },
          {
            "Comment": "skopeo-tests is earlier than 2:tests-1.14.5-3.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838026"
          },
          {
            "Comment": "slirp4netns is earlier than 0:1.2.3-1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838027"
          },
          {
            "Comment": "toolbox is earlier than 0:0.0.99.5-2.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838028"
          },
          {
            "Comment": "toolbox-tests is earlier than 0:tests-0.0.99.5-2.0.1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838029"
          },
          {
            "Comment": "cockpit-podman is earlier than 0:podman-84.1-1.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838030"
          },
          {
            "Comment": "container-selinux is earlier than 2:selinux-2.229.0-2.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838031"
          },
          {
            "Comment": "python-podman is earlier than 0:podman-4.9.0-2.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838032"
          },
          {
            "Comment": "udica is earlier than 0:0.2.6-21.module+an8.9.0+11207+6086c433",
            "TestRef": "oval:cn.openanolis:tst:20240838033"
          },
          {
            "Comment": "podman-docker is earlier than 4:docker-4.9.4-12.0.1.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838034"
          },
          {
            "Comment": "python3-podman is earlier than 0:podman-4.9.0-2.module+an8.9.0+11235+293febc5",
            "TestRef": "oval:cn.openanolis:tst:20240838035"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}