{
  "ID": "oval:cn.openanolis:def:20240544",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0544: grub2 security update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0544",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0544",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2023-4692:\nAn out-of-bounds write flaw was found in grub2's NTFS filesystem driver. This issue may allow an attacker to present a specially crafted NTFS filesystem image, leading to grub's heap metadata corruption. In some circumstances, the attack may also corrupt the UEFI firmware heap metadata. As a result, arbitrary code execution and secure boot protection bypass may be achieved.\n\nCVE-2023-4693:\nAn out-of-bounds read flaw was found on grub2's NTFS filesystem driver. This issue may allow a physically present attacker to present a specially crafted NTFS file system image to read arbitrary memory locations. A successful attack allows sensitive data cached in memory or EFI variable values to be leaked, presenting a high Confidentiality risk.\n\nCVE-2024-1048:\nA flaw was found in the grub2-set-bootflag utility of grub2. After the fix of CVE-2019-14865, grub2-set-bootflag will create a temporary file with the new grubenv content and rename it to the original grubenv file. If the program is killed before the rename operation, the temporary file will not be removed and may fill the filesystem when invoked multiple times, resulting in a filesystem out of free inodes or blocks.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2024-06-28"
      },
      "Updated": {
        "Date": "2024-07-01"
      },
      "Cves": [
        {
          "ID": "CVE-2023-4692",
          "CVSS3": "7.5/CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-4692",
          "CWE": "CWE-122",
          "Public": "20240628"
        },
        {
          "ID": "CVE-2023-4693",
          "CVSS3": "5.3/CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2023-4693",
          "CWE": "CWE-125",
          "Public": "20240628"
        },
        {
          "ID": "CVE-2024-1048",
          "CVSS3": "3.3/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
          "Impact": "Low",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-1048",
          "CWE": "CWE-459",
          "Public": "20240628"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "grub2-efi-aa64 is earlier than 1:efi-aa64-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544001"
          },
          {
            "Comment": "grub2-efi-aa64-cdboot is earlier than 1:efi-aa64-cdboot-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544002"
          },
          {
            "Comment": "grub2-tools is earlier than 1:tools-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544003"
          },
          {
            "Comment": "grub2-tools-extra is earlier than 1:tools-extra-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544004"
          },
          {
            "Comment": "grub2-tools-minimal is earlier than 1:tools-minimal-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544005"
          },
          {
            "Comment": "grub2-efi-ia32 is earlier than 1:efi-ia32-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544006"
          },
          {
            "Comment": "grub2-efi-ia32-cdboot is earlier than 1:efi-ia32-cdboot-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544007"
          },
          {
            "Comment": "grub2-efi-x64 is earlier than 1:efi-x64-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544008"
          },
          {
            "Comment": "grub2-efi-x64-cdboot is earlier than 1:efi-x64-cdboot-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544009"
          },
          {
            "Comment": "grub2-pc is earlier than 1:pc-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544010"
          },
          {
            "Comment": "grub2-tools-efi is earlier than 1:tools-efi-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544011"
          },
          {
            "Comment": "grub2 is earlier than 1:2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544012"
          },
          {
            "Comment": "grub2-common is earlier than 1:common-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544013"
          },
          {
            "Comment": "grub2-efi-aa64-modules is earlier than 1:efi-aa64-modules-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544014"
          },
          {
            "Comment": "grub2-efi-ia32-modules is earlier than 1:efi-ia32-modules-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544015"
          },
          {
            "Comment": "grub2-efi-x64-modules is earlier than 1:efi-x64-modules-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544016"
          },
          {
            "Comment": "grub2-pc-modules is earlier than 1:pc-modules-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544017"
          },
          {
            "Comment": "grub2-efi-loongarch64 is earlier than 1:efi-loongarch64-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544018"
          },
          {
            "Comment": "grub2-efi-loongarch64-cdboot is earlier than 1:efi-loongarch64-cdboot-2.02-150.0.2.an8",
            "TestRef": "oval:cn.openanolis:tst:20240544019"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}