{
  "ID": "oval:cn.openanolis:def:20240747",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2024:0747: httpd:2.4 security update (Important)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2024:0747",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2024:0747",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2024-38473:\nEncoding problem in mod_proxy in Apache HTTP Server 2.4.59 and earlier allows request URLs with incorrect encoding to be sent to backend services, potentially bypassing authentication via crafted requests.\nUsers are recommended to upgrade to version 2.4.60, which fixes this issue.\n\nCVE-2024-38474:\nSubstitution encoding issue in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows attacker to execute scripts in\ndirectories permitted by the configuration but not directly reachable by any URL or source disclosure of scripts meant to only to be executed as CGI.\nUsers are recommended to upgrade to version 2.4.60, which fixes this issue.\nSome RewriteRules that capture and substitute unsafely will now fail unless rewrite flag \"UnsafeAllow3F\" is specified.\n\nCVE-2024-38475:\nImproper escaping of output in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows an attacker to map URLs to filesystem locations that are permitted to be served by the server but are not intentionally/directly reachable by any URL, resulting in code execution or source code disclosure. \nSubstitutions in server context that use a backreferences or variables as the first segment of the substitution are affected.  Some unsafe RewiteRules will be broken by this change and the rewrite flag \"UnsafePrefixStat\" can be used to opt back in once ensuring the substitution is appropriately constrained.\n\nCVE-2024-38477:\nnull pointer dereference in mod_proxy in Apache HTTP Server 2.4.59 and earlier allows an attacker to crash the server via a malicious request.\nUsers are recommended to upgrade to version 2.4.60, which fixes this issue.\n\nCVE-2024-39573:\nPotential SSRF in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows an attacker to cause unsafe RewriteRules to unexpectedly setup URL's to be handled by mod_proxy.\nUsers are recommended to upgrade to version 2.4.60, which fixes this issue.",
    "Advisory": {
      "Severity": "Important",
      "Issued": {
        "Date": "2024-07-30"
      },
      "Updated": {
        "Date": "2024-07-30"
      },
      "Cves": [
        {
          "ID": "CVE-2024-38473",
          "CVSS3": "5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-38473",
          "CWE": "CWE-116",
          "Public": "20240730"
        },
        {
          "ID": "CVE-2024-38474",
          "CVSS3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-38474",
          "CWE": "CWE-116",
          "Public": "20240730"
        },
        {
          "ID": "CVE-2024-38475",
          "CVSS3": "9.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "Impact": "Critical",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-38475",
          "CWE": "CWE-116",
          "Public": "20240730"
        },
        {
          "ID": "CVE-2024-38477",
          "CVSS3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-38477",
          "CWE": "CWE-476",
          "Public": "20240730"
        },
        {
          "ID": "CVE-2024-39573",
          "CVSS3": "7.4/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2024-39573",
          "CWE": "CWE-20",
          "Public": "20240730"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "httpd is earlier than 0:2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747001"
          },
          {
            "Comment": "httpd-devel is earlier than 0:devel-2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747002"
          },
          {
            "Comment": "httpd-tools is earlier than 0:tools-2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747003"
          },
          {
            "Comment": "mod_http2 is earlier than 0:1.15.7-10.module+an8.9.0+11211+52cfe4f7",
            "TestRef": "oval:cn.openanolis:tst:20240747004"
          },
          {
            "Comment": "mod_ldap is earlier than 0:2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747005"
          },
          {
            "Comment": "mod_md is earlier than 1:2.0.8-8.module+an8.7.0+10879+020f8869",
            "TestRef": "oval:cn.openanolis:tst:20240747006"
          },
          {
            "Comment": "mod_proxy_html is earlier than 1:2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747007"
          },
          {
            "Comment": "mod_session is earlier than 0:2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747008"
          },
          {
            "Comment": "mod_ssl is earlier than 1:2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747009"
          },
          {
            "Comment": "httpd-filesystem is earlier than 0:filesystem-2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747010"
          },
          {
            "Comment": "httpd-manual is earlier than 0:manual-2.4.37-65.0.1.module+an8.9.0+11231+4260f212.1",
            "TestRef": "oval:cn.openanolis:tst:20240747011"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}