{
  "ID": "oval:cn.openanolis:def:20220433",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2022:0433: openssh security, bug fix, and enhancement update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2022:0433",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2022:0433",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2018-20685:\nIn OpenSSH 7.9, scp.c in the scp client allows remote SSH servers to bypass intended access restrictions via the filename of . or an empty filename. The impact is modifying the permissions of the target directory on the client side.\n\nCVE-2019-6109:\nAn issue was discovered in OpenSSH 7.9. Due to missing character encoding in the progress display, a malicious server (or Man-in-The-Middle attacker) can employ crafted object names to manipulate the client output, e.g., by using ANSI control codes to hide additional files being transferred. This affects refresh_progress_meter() in progressmeter.c.\n\nCVE-2019-6111:\nAn issue was discovered in OpenSSH 7.9. Due to the scp implementation being derived from 1983 rcp, the server chooses which files/directories are sent to the client. However, the scp client only performs cursory validation of the object name returned (only directory traversal attacks are prevented). A malicious scp server (or Man-in-The-Middle attacker) can overwrite arbitrary files in the scp client target directory. If recursive operation (-r) is performed, the server can manipulate subdirectories as well (for example, to overwrite the .ssh/authorized_keys file).\n\nCVE-2020-14145:\nThe client side in OpenSSH 5.7 through 8.4 has an Observable Discrepancy leading to an information leak in the algorithm negotiation. This allows man-in-the-middle attackers to target initial connection attempts (where no host key for the server has been cached by the client). NOTE: some reports state that 8.5 and 8.6 are also affected.\n\nCVE-2021-41617:\nsshd in OpenSSH 6.2 through 8.x before 8.8, when certain non-default configurations are used, allows privilege escalation because supplemental groups are not initialized as expected. Helper programs for AuthorizedKeysCommand and AuthorizedPrincipalsCommand may run with privileges associated with group memberships of the sshd process, if the configuration specifies running the command as a different user.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2022-06-15"
      },
      "Updated": {
        "Date": "2022-11-30"
      },
      "Cves": [
        {
          "ID": "CVE-2018-20685",
          "CVSS3": "5.3/CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2018-20685",
          "CWE": "CWE-20",
          "Public": "20220615"
        },
        {
          "ID": "CVE-2019-6109",
          "CVSS3": "3.1/CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N",
          "Impact": "Low",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2019-6109",
          "CWE": "CWE-451",
          "Public": "20220615"
        },
        {
          "ID": "CVE-2019-6111",
          "CVSS3": "5.3/CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2019-6111",
          "CWE": "CWE-20",
          "Public": "20220615"
        },
        {
          "ID": "CVE-2020-14145",
          "CVSS3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2020-14145",
          "CWE": "CWE-203",
          "Public": "20220615"
        },
        {
          "ID": "CVE-2021-41617",
          "CVSS3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Impact": "Important",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-41617",
          "CWE": "CWE-273",
          "Public": "20220615"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "openssh is earlier than 0:8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433001"
          },
          {
            "Comment": "openssh-askpass is earlier than 0:askpass-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433002"
          },
          {
            "Comment": "openssh-cavs is earlier than 0:cavs-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433003"
          },
          {
            "Comment": "openssh-clients is earlier than 0:clients-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433004"
          },
          {
            "Comment": "openssh-keycat is earlier than 0:keycat-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433005"
          },
          {
            "Comment": "openssh-ldap is earlier than 0:ldap-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433006"
          },
          {
            "Comment": "openssh-server is earlier than 0:server-8.0p1-13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433007"
          },
          {
            "Comment": "pam_ssh_agent_auth is earlier than 0:0.10.3-7.13.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220433008"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}