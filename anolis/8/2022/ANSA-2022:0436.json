{
  "ID": "oval:cn.openanolis:def:20220436",
  "Version": "1",
  "Class": "patch",
  "Metadata": {
    "Title": "ANSA-2022:0436: samba security, bug fix, and enhancement update (Moderate)",
    "Affected": {
      "Family": "unix",
      "Platform": [
        "Anolis OS 8"
      ]
    },
    "References": [
      {
        "RefID": "ANSA-2022:0436",
        "RefURL": "https://anas.openanolis.cn/errata/detail/ANSA-2022:0436",
        "Source": "ANSA"
      }
    ],
    "Description": "Package updates are available for Anolis 8 that fix the following vulnerabilities:\n\nCVE-2021-20316:\nA flaw was found in the way Samba handled file/directory metadata. This flaw allows an authenticated attacker with permissions to read or modify share metadata, to perform this operation outside of the share.\n\nCVE-2021-44141:\nAll versions of Samba prior to 4.15.5 are vulnerable to a malicious client using a server symlink to determine if a file or directory exists in an area of the server file system not exported under the share definition. SMB1 with unix extensions has to be enabled in order for this attack to succeed.",
    "Advisory": {
      "Severity": "Moderate",
      "Issued": {
        "Date": "2022-06-15"
      },
      "Updated": {
        "Date": "2022-06-23"
      },
      "Cves": [
        {
          "ID": "CVE-2021-20316",
          "CVSS3": "5.9/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-20316",
          "CWE": "CWE-362",
          "Public": "20220615"
        },
        {
          "ID": "CVE-2021-44141",
          "CVSS3": "6.5/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "Impact": "Moderate",
          "Href": "https://anas.openanolis.cn/cves/detail/CVE-2021-44141",
          "CWE": "CWE-59",
          "Public": "20220615"
        }
      ],
      "AffectedCpeList": [
        "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:* "
      ]
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": null,
        "Criterions": [
          {
            "Comment": "ctdb is earlier than 0:4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436001"
          },
          {
            "Comment": "libsmbclient is earlier than 0:4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436002"
          },
          {
            "Comment": "libwbclient is earlier than 0:4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436003"
          },
          {
            "Comment": "python3-samba is earlier than 0:samba-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436004"
          },
          {
            "Comment": "python3-samba-test is earlier than 0:samba-test-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436005"
          },
          {
            "Comment": "samba is earlier than 0:4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436006"
          },
          {
            "Comment": "samba-client is earlier than 0:client-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436007"
          },
          {
            "Comment": "samba-client-libs is earlier than 0:client-libs-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436008"
          },
          {
            "Comment": "samba-common-libs is earlier than 0:common-libs-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436009"
          },
          {
            "Comment": "samba-common-tools is earlier than 0:common-tools-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436010"
          },
          {
            "Comment": "samba-krb5-printing is earlier than 0:krb5-printing-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436011"
          },
          {
            "Comment": "samba-libs is earlier than 0:libs-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436012"
          },
          {
            "Comment": "samba-test is earlier than 0:test-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436013"
          },
          {
            "Comment": "samba-test-libs is earlier than 0:test-libs-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436014"
          },
          {
            "Comment": "samba-winbind is earlier than 0:winbind-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436015"
          },
          {
            "Comment": "samba-winbind-clients is earlier than 0:winbind-clients-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436016"
          },
          {
            "Comment": "samba-winbind-krb5-locator is earlier than 0:winbind-krb5-locator-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436017"
          },
          {
            "Comment": "samba-winbind-modules is earlier than 0:winbind-modules-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436018"
          },
          {
            "Comment": "samba-winexe is earlier than 0:winexe-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436019"
          },
          {
            "Comment": "samba-common is earlier than 0:common-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436020"
          },
          {
            "Comment": "samba-pidl is earlier than 0:pidl-4.15.5-5.0.1.an8",
            "TestRef": "oval:cn.openanolis:tst:20220436021"
          }
        ]
      }
    ],
    "Criterions": [
      {
        "Comment": "Anolis OS 8 is installed",
        "TestRef": "oval:cn.openanolis:tst:1"
      }
    ]
  }
}